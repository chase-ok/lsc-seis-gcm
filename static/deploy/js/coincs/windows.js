!function(){require.config({paths:{jquery:"//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min","jquery-ui":"//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min",datatables:"//ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.4/jquery.dataTables.min",d3:"//cdnjs.cloudflare.com/ajax/libs/d3/3.2.2/d3.v3"},shim:{d3:{exports:"d3"}}})}.call(this),function(){define("utils",["d3"],function(t){var n,e,r;return n=function(){function t(t,n){this._func=t,this._period=null!=n?n:1e3,this._id=null,this._running=!1}return t.prototype.func=function(t){return null!=t?(this._func=t,this.running()&&this.reset(),this):this._func},t.prototype.period=function(t){return null!=t?(this._period=t,this.running()&&this.reset(),this):this._period},t.prototype.running=function(t){return null!=t?(this._running=t,null!=this._id&&(clearInterval(this._id),this._id=null),t&&(this._id=setInterval(this.func(),this.period())),this):this._running},t.prototype.reset=function(){return this.running(!1),this.running(!0)},t}(),{definitions:window.definitions,describe:function(t,n){var e,r;for(e in n)r=n[e],t=t.attr(e,r);return t},mergeObj:function(t,n){var e,r;null==t&&(t={});for(e in n)r=n[e],null!=r&&(t[e]=r);return t},isEmpty:function(t){var n,e;for(n in t)if(e=t[n],t.hasOwnProperty(n))return!1;return!0},mash:function(t){var n,e,r,i;for(n={},r=0,i=t.length;i>r;r++)e=t[r],n[e[0]]=e[1];return n},loadJSON:e=function(n,r,i){return null==i&&(i=3),i>0?t.json(definitions.webRoot+n,function(t,s){return null==t&&s.success?r(s.data):(null!=t&&console.log(t),null!=s&&console.log(s.error),setTimeout(function(){return e(n,r,i-1)},10))}):void 0},loadUnwrappedJSON:r=function(n,e,i){return null==i&&(i=3),i>0?t.json(definitions.webRoot+n,function(t,s){return null!=t?(null!=t&&console.log(t),setTimeout(function(){return r(n,e,i-1)},10)):e(s)}):void 0},property:function(t){var n,e,r;return e=void 0,n="function"==typeof t||null==t.get?function(t){return t}:t.get,r="function"==typeof t?t:null!=t.set?t.set:function(){throw new Error("property is read-only")},function(t){return null!=t?(e=r.call(this,t,e),this):n.call(this,e)}},degrees:function(t){return 180*(t/Math.PI)},radians:function(t){return Math.PI/180*t},IntervalFunc:n}})}.call(this),function(){var t={}.hasOwnProperty,n=function(n,e){function r(){this.constructor=n}for(var i in e)t.call(e,i)&&(n[i]=e[i]);return r.prototype=e.prototype,n.prototype=new r,n.__super__=e.prototype,n},e=[].indexOf||function(t){for(var n=0,e=this.length;e>n;n++)if(n in this&&this[n]===t)return n;return-1};define("plots",["utils","d3","jquery"],function(t,r){var i,s,o,a,l,u,c,h,p,f,d;return h=t.mash,c=t.describe,p=t.mergeObj,f=t.property,d=0,u={top:40,right:70,bottom:50,left:60},a=function(){function t(t,n,e){var i;this.rootSelector=null!=t?t:"body",this.margin=null!=n?n:u,this.dimensions=null!=e?e:["x","y"],this.root=r.select(this.rootSelector),this.size={x:this.root.attr("width"),y:this.root.attr("height")},this.canvasSize={x:this.size.x-this.margin.left-this.margin.right,y:this.size.y-this.margin.top-this.margin.bottom},this._scales=h(function(){var t,n,e,s;for(e=this.dimensions,s=[],t=0,n=e.length;n>t;t++)i=e[t],s.push([i,r.scale.linear()]);return s}.call(this)),this._title="",this._prepared=!1}return t.prototype.select=function(t){return r.select(""+this.rootSelector+" "+t)},t.prototype.scales=function(t,n){var e,r;if(null==n&&(n={x:[0,this.canvasSize.x],y:[this.canvasSize.y,0]}),null!=t)return p(this._scales,t),this.declareDirty(),this;for(e in n)r=n[e],this._scales[e].range(r);return this._scales},t.prototype.title=function(t){return null!=t?(this._title=t,this._prepared&&this.select(".title").text(t),this):this._title},t.prototype.limits=function(t){var n,e;if(null!=t){for(n in t)e=t[n],this._scales[n].domain(e);return this.declareDirty(),this}return h(function(){var t,e,r,i;for(r=this.dimensions,i=[],t=0,e=r.length;e>t;t++)n=r[t],i.push([n,this._scales[n].domain()]);return i}.call(this))},t.prototype.maps=function(){var t;return h(function(){var n,e,r,i;for(r=this.dimensions,i=[],n=0,e=r.length;e>n;n++)t=r[n],i.push([t,this._scales[t].copy()]);return i}.call(this))},t.prototype.clear=function(){return this._prepared?(this.canvas.remove(),this._prepared=!1,this.prepare()):void 0},t.prototype.prepare=function(){return this._prepared?!1:(this._prepareCanvas(),this._prepareCanvasClipPath(),this._prepareTitle(),this._prepared=!0)},t.prototype.declareDirty=function(){return this.clear(),this.prepare(),this},t.prototype._prepareCanvas=function(){return this.canvas=c(this.root.append("g"),{"class":"canvas",transform:"translate("+this.margin.left+", "+this.margin.top+")"}),this.svgDefs=this.canvas.append("defs")},t.prototype._prepareCanvasClipPath=function(){return this.canvasClipId="canvas-clip-"+(d+=1),this._canvasClip=this.canvas.append("clipPath").attr("id",this.canvasClipId),c(this._canvasClip.append("rect"),{x:0,y:0,width:this.canvasSize.x,height:this.canvasSize.y})},t.prototype._prepareTitle=function(){var t;return t=20,c(this.canvas.append("text").text(this._title),{x:this.canvasSize.x/2,y:-this.margin.top+1.1*t,"text-anchor":"middle","font-size":""+t,"class":"title axis-label"})},t}(),i=function(t){function e(t,n){var r;null==t&&(t="body"),null==n&&(n=["x","y"]),e.__super__.constructor.call(this,t,null,n),this._axisLabels=h(function(){var t,n,e,i;for(e=this.dimensions,i=[],t=0,n=e.length;n>t;t++)r=e[t],i.push([r,r]);return i}.call(this)),this._ticks=h(function(){var t,n,e,i;for(e=this.dimensions,i=[],t=0,n=e.length;n>t;t++)r=e[t],i.push([r,null]);return i}.call(this)),this._showGrid=!0}return n(e,t),e.prototype.select=function(t){return r.select(""+this.rootSelector+" "+t)},e.prototype.axisLabels=function(t){var n,e,r;if(null!=t){if(p(this._axisLabels,t),this._prepared){r=this._axisLabels;for(n in r)e=r[n],this.select("."+n+".axis-label").text(e)}return this}return this._axisLabels},e.prototype.ticks=function(t){return null!=t?(p(this._ticks,t),this.declareDirty(),this):this._ticks},e.prototype.showGrid=function(t){return null!=t?(this._showGrid=t,this.declareDirty(),this):this._showGrid},e.prototype.prepare=function(){return e.__super__.prepare.call(this)?(this._prepareGrid(),this._prepareAxes(),this._prepareAxisLabels()):void 0},e.prototype._prepareGrid=function(){var t;if(this._showGrid)return t=this._makeAxes(),t.x.tickSize(-this.canvasSize.y,0,0).tickFormat(""),t.y.tickSize(-this.canvasSize.x,0,0).tickFormat(""),c(this.canvas.append("g"),{"class":"x grid",transform:"translate(0, "+this.canvasSize.y+")"}).call(t.x),c(this.canvas.append("g"),{"class":"y grid"}).call(t.y)},e.prototype._prepareAxisLabels=function(){var t,n;return t=15,c(this.canvas.append("text").text(this._axisLabels.x),{x:this.canvasSize.x/2,y:this.canvasSize.y+this.margin.bottom-1.1*t,"text-anchor":"middle","font-size":""+t,"class":"x axis-label"}),n=this.canvas.append("g").attr("transform","rotate(-90)"),c(n.append("text").text(this._axisLabels.y),{x:-this.canvasSize.y/2,y:1.1*t-this.margin.left,"text-anchor":"middle","font-size":""+t,"class":"y axis-label"})},e.prototype._prepareAxes=function(){var t;return t=this._makeAxes(),c(this.canvas.append("g"),{"class":"x axis",transform:"translate(0, "+this.canvasSize.y+")"}).call(t.x),c(this.canvas.append("g"),{"class":"y axis"}).call(t.y)},e.prototype._makeAxes=function(t){var n,e,i,s,o,a,l;for(null==t&&(t={x:"bottom",y:"left"}),n={},s=this.scales(),l=this.dimensions,o=0,a=l.length;a>o;o++)i=l[o],e=r.svg.axis().scale(s[i]).orient(t[i]),null!=this._ticks[i]&&e.ticks.apply(e,this._ticks[i]),n[i]=e;return n},e}(a),l=function(t){function e(t,n){null==n&&(n=["x","y","z"]),e.__super__.constructor.call(this,t,n),this._zBarWidth=30,this.canvasSize.x-=this._zBarWidth,this._zColor={lower:r.rgb(0,0,0),upper:r.rgb(255,0,0)}}return n(e,t),e.prototype.zColor=function(t){return null!=t?(p(this._zColor(t)),this.declareDirty(),this):this._zColor},e.prototype.scales=function(t,n){var r,i;if(null==n&&(n={z:[this.canvasSize.y,0]}),null!=t)return e.__super__.scales.call(this,t);t=e.__super__.scales.call(this);for(r in n)i=n[r],t[r].range(i);return t},e.prototype.maps=function(){var t,n,i,s;return i=e.__super__.maps.call(this),n=this.canvasSize.y,s=this.zColor(),t=r.interpolateRgb(s.lower,s.upper),{x:i.x,y:i.y,z:function(e){return t(1-i.z(e)/n)}}},e.prototype.prepare=function(){return e.__super__.prepare.call(this)?(this._prepareZGradient(),this._prepareZColorBar(),this._prepareZAxis(),this._prepareZLabel()):void 0},e.prototype._prepareZGradient=function(){var t;return t=this.zColor(),this._zGradient=c(this.svgDefs.append("linearGradient"),{id:"zGradient",x1:"0%",y1:"100%",x2:"0%",y2:"0%"}),c(this._zGradient.append("stop"),{offset:"0%","stop-color":t.lower,"stop-opacity":1}),c(this._zGradient.append("stop"),{offset:"100%","stop-color":t.upper,"stop-opacity":1})},e.prototype._prepareZColorBar=function(){var t;return t=10,this._zColorBar=c(this.canvas.append("rect"),{x:this.canvasSize.x+t,y:0,width:this._zBarWidth-t,height:this.canvasSize.y,fill:"url(#"+this._zGradient.attr("id")+")"})},e.prototype._prepareZAxis=function(){return c(this.canvas.append("g"),{"class":"z axis",transform:"translate("+(this.canvasSize.x+this._zBarWidth)+", 0)"}).call(this._makeAxes({z:"right"}).z)},e.prototype._prepareZLabel=function(){var t,n;return t=15,n=this.canvas.append("g").attr("transform","rotate(-90)"),c(n.append("text").text(this.axisLabels().z),{x:-this.canvasSize.y/2,y:this.canvasSize.x+this._zBarWidth+this.margin.right,"text-anchor":"middle","font-size":""+t,"class":"z axis-label"})},e}(i),s=function(t){function e(t){e.__super__.constructor.call(this,t),this.bins([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20]),this.useProbability(!0),this.limits({y:[0,1]})}return n(e,t),e.prototype.bins=function(t){return null!=t?(this._bins=t,this.declareDirty(),this):this._bins},e.prototype.useProbability=function(t){return null!=t?(this._useProbability=t,this.axisLabels({y:t?"Probability":"Frequency"}),this.declareDirty(),this):this._useProbability},e.prototype.plot=function(t){var n,e,i,s,o,a;return this.prepare(),a=this.scales(),s=a.x,o=a.y,e=r.layout.histogram(),null!=this.bins()&&e.bins(this.bins()),e.frequency(!this.useProbability()),n=e(t),this.canvas=r.select(this.rootSelector+">.canvas"),i=this.canvas.selectAll("rect.histogram-bar").data(n),c(i.enter().append("rect"),{"class":"histogram-bar",x:function(t){return Math.floor(s(t.x))},y:function(t){return o(t.y)},width:function(t){return Math.ceil(s(t.x+t.dx)-s(t.x))},height:function(t){return o(0)-o(t.y)},fill:"steelblue","shape-rendering":"crispEdge"}),i.exit().remove()},e}(i),o=function(t){function i(t,n){null==t&&(t="body"),null==n&&(n=["x","y","color","size"]),i.__super__.constructor.call(this,t,n),this.showLegend(!1),this.scales({color:r.scale.category20(),size:r.scale.ordinal()}),this.groups(["default"])}return n(i,t),i.prototype.showLegend=f(function(t){return this.declareDirty(),t}),i.prototype.groups=f(function(t){var n;return this.scales().color.domain(t),this.scales().size.domain(t).range(function(){var e,r,i;for(i=[],e=0,r=t.length;r>e;e++)n=t[e],i.push(5);return i}()),this.declareDirty(),t}),i.prototype.sizes=f({get:function(){var t,n,e;return e=this.scales().size.range(),t=this.groups(),h(function(){var r,i,s;for(s=[],n=r=0,i=t.length;i>=0?i>r:r>i;n=i>=0?++r:--r)s.push([t[n],e[n]]);return s}())},set:function(t){var n,e,r,i,s,o;for(r=this.scales().size.range(),n=this.groups(),e=s=0,o=n.length;o>=0?o>s:s>o;e=o>=0?++s:--s)i=t[n[e]],null!=i&&(r[e]=i);return this.scales().size.range(r),this.declareDirty()}}),i.prototype.colors=f({get:function(){var t,n,e;return e=this.scales().color.range(),t=this.groups(),h(function(){var r,i,s;for(s=[],n=r=0,i=t.length;i>=0?i>r:r>i;n=i>=0?++r:--r)s.push([t[n],e[n]]);return s}())},set:function(t){var n,e,r,i,s,o;for(i=this.scales().color.range(),e=this.groups(),r=s=0,o=e.length;o>=0?o>s:s>o;r=o>=0?++s:--s)n=t[e[r]],null!=n&&(i[r]=n);return this.scales().color.range(i),this.declareDirty()}}),i.prototype.prepare=function(){return i.__super__.prepare.call(this)?this._prepareLegend():void 0},i.prototype._prepareLegend=function(){var t,n,e,i,s,o,a=this;if(this.showLegend())return s=5,i={x:100,y:20},n=this.groups(),e=c(this.canvas.append("g").selectAll(".legend").data(r.zip(function(){o=[];for(var t=0,e=n.length;e>=0?e>t:t>e;e>=0?t++:t--)o.push(t);return o}.apply(this),n)).enter().append("g"),{"class":"legend",transform:function(t){return"translate("+(a.canvasSize.x-i.x)+", "+t[0]*(i.y+s)+")"}}),t=this.scales().color,c(e.append("rect"),{x:0,y:0,width:i.x,height:i.y,stroke:"none",fill:function(n){return t(n[1])}}),c(e.append("text").text(function(t){return t[1]}),{x:3,y:i.y-5,"text-anchor":"start","font-size":""+(i.y-8),"font-weight":"bold",fill:"white"})},i.prototype.plot=function(t){var n,i,s,o,a,l,u,h,p,f,d,y,_,g,v;for(this.prepare(),o=[],_=this.groups(),p=0,d=_.length;d>p;p++)if(s=_[p],!(e.call(t,s)<0))for(g=t[s],f=0,y=g.length;y>f;f++)a=g[f],o.push({group:s,point:a});return v=this.scales(),u=v.x,h=v.y,i=v.color,l=v.size,this.canvas=r.select(this.rootSelector+">.canvas"),n=this.canvas.selectAll("circle.scatter-point").data(o),c(n.enter().append("circle"),{"class":"scatter-point","clip-path":"url(#"+this.canvasClipId+")"}),c(n.transition().duration(500),{cx:function(t){return u(t.point[0])},cy:function(t){return h(t.point[1])},r:function(t){return l(t.group)},stroke:"none",fill:function(t){return i(t.group)}}),n.exit().remove()},i}(i),{SvgPlot:a,BasicPlot:i,ZColorPlot:l,Histogram:s,ScatterPlot:o}})}.call(this),function(){define("coincs/windows",["utils","plots","d3","jquery","jquery-ui"],function(t,n,e,r){var i;return console.log("Starting"),i=t.definitions.group,r(function(){var r;return r=new n.ScatterPlot("#scatter"),r.title(i.name),r.axisLabels({x:"Coincidence Window [s]",y:"Field"}),r.groups(["Actual","Time Offset"]),r.sizes({Actual:6,"Time Offset":3}),r.colors({Actual:"black","Time Offset":"#999999"}),r.showLegend(!0),t.loadUnwrappedJSON("/data/coinc/windows-"+i.id+".json",function(n){return t.loadUnwrappedJSON("/data/coinc/windows-"+i.id+"-without-exact.json",function(t){var i,s,o,a,l,u,c,h,p;for(n=function(){var t,e,r;for(r=[],t=0,e=n.length;e>t;t++)s=n[t],s.window<=100&&r.push(s);return r}(),u=function(i,o,a){var l,u,c,h,p,f,d,y,_,g,v;for(r.axisLabels({y:i}),l=[],c=[],g=a?t:n,f=0,y=g.length;y>f;f++)for(s=g[f],l.push([s.window,o(s.actual)]),v=s.rand,d=0,_=v.length;_>d;d++)u=v[d],c.push([s.window,o(u)]);return p=e.extent(function(){var t,n,e;for(e=[],t=0,n=l.length;n>t;t++)h=l[t],e.push(h[1]);return e}().concat(function(){var t,n,e;for(e=[],t=0,n=c.length;n>t;t++)h=c[t],e.push(h[1]);return e}())),p[0]===p[1]?p[1]+=1:p[1]*=1.1,r.limits({x:e.extent(function(){var t,e,r;for(r=[],t=0,e=n.length;e>t;t++)h=n[t],r.push(h.window);return r}()),y:p}),r.plot({Actual:l,"Time Offset":c})},i=[["Number of Coincidences",function(t){return t.num.overall_coincs}],["Coincidence Rate [1/s]",function(t){return t.rates.overall_coincs}],["Coincidence Rate Ratio",function(t){return t.rates.overall_coincs/t.rates.overall_triggers}],["Mean Coincidence Length",function(t){return t.lengths.mean}],["Max Coincidence Length",function(t){return t.lengths.max}],["Mean Abs. Frequency Diff [Hz]",function(t){return t.freqs.diffs.mean}],["Frequency Spearman R",function(t){return t.freqs.correl.spearmanr[0]}],["Frequency Pearson R",function(t){return t.freqs.correl.pearsonr[0]}],["Mean Abs. SNR Diff",function(t){return t.snrs.diffs.mean}],["SNR Spearman R",function(t){return t.snrs.correl.spearmanr[0]}],["SNR Pearson R",function(t){return t.snrs.correl.pearsonr[0]}],["Mean dt [s]",function(t){return t.dts.mean}],["Median dt [s]",function(t){return t.dts.median}],["Max dt [s]",function(t){return t.dts.max}]],a=[],h=0,p=i.length;p>h;h++)o=i[h],a.push(o.concat([!1])),o[0]+=" without Exact",a.push(o.concat([!0]));return u.apply(null,a[0]),c=e.select("body").append("select"),l=c.selectAll("option").data(a).enter().append("option"),l.text(function(t){return t[0]}),c.on("change",function(){return console.log(c.node()),u.apply(null,a[c.node().selectedIndex])})})})})})}.call(this);